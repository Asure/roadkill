***
*** FILE: DRAS.ASM
*** DERBY RACE ANIMATION SCRIPTS
***
*** JFL 11 FEB 93; SPLIT FROM DRA.ASM
*** JFL 16 FEB 93
*** JFL 14 APR 93; MINE STAYS CLOSED
*** JFL 16 APR 93; MEDUP/DOWN
***
	.MLIB	"APMACS.LIB"
	.FILE	"DRAS.ASM"
	.TITLE	" <<< DERBY RACE -- ANIMATION SCRIPTS >>>"
	.WIDTH	132
	.OPTION	B,D,L,T
	.MNOLIST

**
** COMPILE FLAGS
**

***********************************************************************
*								         *
* 	COPYRIGHT (C) 1992 MIDWAY MANUFACTURING COMPANY.		 *
* 		       ALL RIGHTS RESERVED.				 *
*								         *
*************************************************************************

*	GET THE SYSTEM STUFF
	.INCLUDE	"AP.H"
	.INCLUDE	"DR.I"
	.INCLUDE	"DRPAL.I"
	.INCLUDE	"DRMIS.I"
	.INCLUDE	"DRA.I"
	.INCLUDE	"IMGTBLM1.GLO"
	.INCLUDE	"IMGTBLM2.GLO"
	.INCLUDE	"IMGTBLC1.GLO"
	.INCLUDE	"IMGTBLC2.GLO"
	.INCLUDE	"IMGTBLB1.GLO"
	.INCLUDE	"IMGTBLF1.GLO"

** OTHERS USE
	.DEF	ASKILL		;DRAS.ASM
	.DEF	ASFLASHKILL	;DRAS.ASM
	.DEF	ASPRSTART     	;DRAS.ASM
	.DEF	ASHITTEST     	;DRAS.ASM
	.DEF	ASMISLBOOM    	;DRAS.ASM
	.DEF	ASMISLFFBOOM	;DRAS.ASM
	.DEF	ASDEFENSEBOOM	;DRAS.ASM
	.DEF	IMAGEROMSIZETBL	;DRAS.ASM
	.DEF	FOURHITFRONT	;DRAS.ASM
	.DEF	FOURHITBACK	;DRAS.ASM
	.DEF	FOURHITMID    	;DRAS.ASM
	.DEF	ASDEATHBOOM	;DRAS.ASM
	.DEF	ASDEADMISL	;DRAS.ASM
	.DEF	ASLMINE		;DRAS.ASM
	.DEF	ASLMINEBOOM	;DRAS.ASM
	.DEF	ASCARFIRE	;DRAS.ASM
	.DEF	CHECKDMA	;DRAS.ASM

	.DEF	OBJINITBLANK	;DRAS.ASM
	.DEF	OBJINITBG     	;DRAS.ASM
	.DEF	OBJINITSPAWN	;DRAS.ASM
	.DEF	OBJINITBLANKAO	;DRAS.ASM
	.DEF	OBJINITMISSILE	;DRAS.ASM
	.DEF	OBJINITAOVEL	;DRAS.ASM
	.DEF	OBJINITDEFMISL	;DRAS.ASM
	.DEF	OBJINITLMINE	;DRAS.ASM
	.DEF	OBJINITFF	;DRAS.ASM
	.DEF	OBJINITDEATHBOOM ;DRAS.ASM
	.DEF	OBJINITDEADMISL ;DRAS.ASM
	.DEF	OBJINITCARFIRE	;DRAS.ASM
	.DEF	OBJINITRUNNER	;DRAS.ASM

** OTHERS USE -- FOR DRA.ASM
	.DEF	ASTHINGA	;DRAS.ASM
	.DEF	ASTHINGB       	;DRAS.ASM
	.DEF	ASDICE		;DRAS.ASM
	.DEF	ASBELT		;DRAS.ASM
	.DEF	ASFTPEDAL     	;DRAS.ASM
	.DEF	ASSTEER		;DRAS.ASM
	.DEF	ASWHEELA      	;DRAS.ASM
	.DEF	ASWHEELB      	;DRAS.ASM
	.DEF	ASRADIATE     	;DRAS.ASM
	.DEF	ASCARBUR      	;DRAS.ASM
	.DEF	ASFILTER      	;DRAS.ASM
	.DEF	ASFLYLANDKILL	;DRAS.ASM
	.DEF	ASTOSCOREBOX	;DRAS.ASM
	.DEF	ASSPARKA      	;DRAS.ASM
	.DEF	ASSPARKB      	;DRAS.ASM
	.DEF	ASBUMPERA     	;DRAS.ASM
	.DEF	ASBUMPERB     	;DRAS.ASM
	.DEF	ASROCKSMALL	;DRAS.ASM
	.DEF	ASSEATA		;DRAS.ASM
	.DEF	ASSEATB		;DRAS.ASM
	.DEF	ASPLATE		;DRAS.ASM
	.DEF	ASMIRROR      	;DRAS.ASM
	.DEF	ASFLAG1		;DRAS.ASM
	.DEF	ASMUFF		;DRAS.ASM
	.DEF	ASGASCAN      	;DRAS.ASM
	.DEF	ASPIST		;DRAS.ASM
	.DEF	ASTOSCORENOBOX	;DRAS.ASM
	.DEF	ASTOSCORENOBOXSOLID;DRAS.ASM
	.DEF	ASHORNORN     	;DRAS.ASM
	.DEF	ASFISH1		;DRAS.ASM
	.DEF	ASFISH2		;DRAS.ASM
	.DEF	ASDISTRBA     	;DRAS.ASM
	.DEF	ASFISH3		;DRAS.ASM
	.DEF	ASDISTRBB     	;DRAS.ASM
	.DEF	ASFISH4		;DRAS.ASM
	.DEF	ASWINGORN     	;DRAS.ASM
	.DEF	ASZTBLHEALTHICON ;DRAS.ASM
	.DEF	ASZTBLMONEYBAGICON ;DRAS.ASM
	.DEF	ASZTBLDETONATEICON ;DRAS.ASM
	.DEF	ASZTBLLMINEICON ;DRAS.ASM
	.DEF	ASZTBLMISSILEICON ;DRAS.ASM
	.DEF	ASZTBLTURBOICON	;DRAS.ASM
	.DEF	ASZTBLSMARTBOMBICON ;DRAS.ASM
	.DEF	ASTOSCOREBOXSOLID ;DRAS.ASM
	.DEF	ASDEATHBOOMTBL	;DRAS.ASM
	.DEF	ASDEATHBOOMTBLX	;DRAS.ASM

	.DEF	SASROLLLEFT	;DRAS.ASM
	.DEF	SASROLLRIGHT	;DRAS.ASM
	.DEF	SASREHIT	;DRAS.ASM
	.DEF	SASTOSSROLLLOOP	;DRAS.ASM
	.DEF	SASROCKUPDOWN	;DRAS.ASM
	.DEF	SASROCKDOWNUP	;DRAS.ASM
	.DEF	SASROCKBACKA	;DRAS.ASM
	.DEF	SASROCKFRONTA	;DRAS.ASM
	.DEF	SASROCKRIGHTA	;DRAS.ASM
	.DEF	SASROCKLEFTA	;DRAS.ASM
	.DEF	MOVINGPARTTBL	;DRAS.ASM
	.DEF	MOVINGPARTTBLX	;DRAS.ASM

** WE USE -- FROM DRA.ASM
	.REF	ANIFRM		;DRA.ASM
	.REF	ANIOFF		;DRA.ASM
	.REF	ANISPAWN	;DRA.ASM
	.REF	ANIPALCONSTSAVE	;DRA.ASM
	.REF	ANIPALCONSTPLAYER ;DRA.ASM
	.REF	ANIPALCONSTICON	;DRA.ASM
	.REF	ANIPALCONSTICONFIRST ;DRA.ASM
	.REF	ANIKILL		;DRA.ASM
	.REF	ANIKILLPOWERUP	;DRA.ASM
	.REF	ANION		;DRA.ASM
	.REF	ANIPALCONSTFIRST;DRA.ASM
	.REF	ANIFLYLANDKILL	;DRA.ASM
	.REF	ANILOOPHERE	;DRA.ASM
	.REF	ANIONOFF	;DRA.ASM
	.REF	ANIHITTEST	;DRA.ASM
	.REF	ANITOSCORENOBOX	;DRA.ASM
	.REF	ANIRETS		;DRA.ASM
	.REF	ANISETSCALETYPE	;DRA.ASM
	.REF	ANITOSCOREBOX	;DRA.ASM
	.REF	ANIPALCONST	;DRA.ASM
	.REF	ANIONTIME4	;DRA.ASM
	.REF	ANITIME4	;DRA.ASM
	.REF	ANIPALCONSTRESTORE ;DRA.ASM
	.REF	ANIOCVECT	;DRA.ASM
	.REF	ANIDEATHBOOM	;DRA.ASM
	.REF	ASIDEATHBOOM2	;DRA.ASM
	.REF	ANIDEADMISL	;DRA.ASM
	.REF	ANIPULL		;DRA.ASM
	.REF	ANICYCLE	;DRA.ASM
	.REF	PUSUMA		;AP.ASM
	.REF	PUSUMB		;AP.ASM

** WE USE -- RAM

**
** DEFINES
**

	.TEXT
	.EVEN

***
*** OBJECT INIT TABLES ----------------------------------------------------
***

OBJINITBLANK
	.LONG	0		;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_JUNK  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPNONE	;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITBG
	.LONG	0		;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_JUNK  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	M_NOTFG		;OFLAGS
	.WORD	STYPNONE	;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITSPAWN
	.LONG	0		;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_FLOATER  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPZ		;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITMISSILE
	.LONG	MISLN_4		;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_MISSILE  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPEMISSILE	;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITBLANKAO
	.LONG	0		;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_JUNK  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPZ		;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITAOVEL
	.LONG	0		;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_FLOATER  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPNONE	;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITDEFMISL
	.LONG	DEFMIS_1A	;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_JUNK  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPZ		;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITDEATHBOOM
	.LONG	EXPL_1		;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_JUNK  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPZOFF+40	;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITDEADMISL
	.LONG	MISSILE_1	;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_FLOATER  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPNONE	;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITLMINE
	.LONG	MINE1		;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_LMINE  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPELMINE	;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITFF
	.LONG	SHOT		;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_FF  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPZ		;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITCARFIRE
	.LONG	SMBOOM1		;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_JUNK  	;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPZ		;OSCALTYP
 	.LONG	0		;CFUNC

OBJINITRUNNER
	.LONG	standA		;IMAGE
	.LONG	0		;COLLISION VECTOR
 	.WORD	OID_RUNNER|M_OIDFAUTOVEL ;OID
	.WORD	DMAWNZ		;OCTRL
	.WORD	0		;OFLAGS
	.WORD	STYPZ		;OSCALTYP
 	.LONG	0		;CFUNC


**
** MOVINGPARTTBL
**
** JFL 26 MAR 93
** JFL 14 APR 93
**
MOVINGPARTTBL
	.LONG	DIRANIMTURBO		;DIRANIM
	
MOVINGPARTTBLX
	
**
** USED TO CHECK IF WE HAVE OVERRUN A ROM
**
** JFL 12 FEB 93
**
IMAGEROMSIZETBL
	.LONG	IMG2X
	.LONG	IMG3X
	.LONG	IMG4X
	.LONG	IMG5X

***
*** --------------------------- ANIMATION SCRIPTS ------------------------
***

***
*** ICON SCRIPTS
***

		

ICONTIME	EQU	6
ASZTBLMONEYBAGICON
	.LONG	AS1MONEYBAGICON
	.LONG	AS1MONEYBAGICON
	.LONG	AS1MONEYBAGICON
	.LONG	AS1MONEYBAGICON
	.LONG	AS1MONEYBAGICON
	.LONG	AS1MONEYBAGICON
	.LONG	AS1MONEYBAGICON
	.LONG	AS1MONEYBAGICON
ASZTBLHEALTHICON
	.LONG	AS1HEALTHICON
	.LONG	AS1HEALTHICON
	.LONG	AS1HEALTHICON
	.LONG	AS1HEALTHICON
	.LONG	AS1HEALTHICON
	.LONG	AS1HEALTHICON
	.LONG	AS1HEALTHICON
	.LONG	AS1HEALTHICON
ASZTBLMISSILEICON
	.LONG	AS1MISSILEICON
	.LONG	AS1MISSILEICON
	.LONG	AS1MISSILEICON
	.LONG	AS1MISSILEICON
	.LONG	AS1MISSILEICON
	.LONG	AS1MISSILEICON
	.LONG	AS1MISSILEICON
	.LONG	AS1MISSILEICON
ASZTBLTURBOICON
	.LONG	AS1TURBOICON
	.LONG	AS1TURBOICON
	.LONG	AS1TURBOICON
	.LONG	AS1TURBOICON
	.LONG	AS1TURBOICON
	.LONG	AS1TURBOICON
	.LONG	AS1TURBOICON
	.LONG	AS1TURBOICON
ASZTBLDETONATEICON
	.LONG	AS1DETONATEICON
	.LONG	AS1DETONATEICON
	.LONG	AS1DETONATEICON
	.LONG	AS1DETONATEICON
	.LONG	AS1DETONATEICON
	.LONG	AS1DETONATEICON
	.LONG	AS1DETONATEICON
	.LONG	AS1DETONATEICON
ASZTBLSMARTBOMBICON
	.LONG	AS1SMARTBOMBICON
	.LONG	AS1SMARTBOMBICON
	.LONG	AS1SMARTBOMBICON
	.LONG	AS1SMARTBOMBICON
	.LONG	AS1SMARTBOMBICON
	.LONG	AS1SMARTBOMBICON
	.LONG	AS1SMARTBOMBICON
	.LONG	AS1SMARTBOMBICON
ASZTBLLMINEICON
	.LONG	AS1LMINEICON
	.LONG	AS1LMINEICON
	.LONG	AS1LMINEICON
	.LONG	AS1LMINEICON
	.LONG	AS1LMINEICON
	.LONG	AS1LMINEICON
	.LONG	AS1LMINEICON
	.LONG	AS1LMINEICON

AS1MONEYBAGICON
	.LONG	MONEYBAG_1		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS2MONEYBAGICON
	.LONG	MONEYBAG_2		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS3MONEYBAGICON
	.LONG	MONEYBAG_3		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG

AS1HEALTHICON
	.LONG	ICN_HEAL		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS2HEALTHICON
	.LONG	HEALTH_2		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS3HEALTHICON
	.LONG	HEALTH_3		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG

AS1TURBOICON
	.LONG	ICN_TURB		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS2TURBOICON
	.LONG	MONEYBAG_2 ;TURBO			;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS3TURBOICON
	.LONG	MONEYBAG_3 ;TURBO			;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG

AS1SMARTBOMBICON
	.LONG	ICN_SPEC		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS2SMARTBOMBICON
	.LONG	SMART_2			;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS3SMARTBOMBICON
	.LONG	SMART_3			;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG

AS1DETONATEICON
	.LONG	ICN_SPEC		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS2DETONATEICON
	.LONG	MONEYBAG_2 ;M_DESTR			;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS3DETONATEICON
	.LONG	MONEYBAG_3 ;M_DESTR			;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG

AS1LMINEICON
	.LONG	ICN_MINE		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG

AS1MISSILEICON
	.LONG	ICN_MISS		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS2MISSILEICON
	.LONG	MISSILE_2		;IMAGE
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIFRM+2		;FUN+ARGCOUNT IN WORDS
	.LONG	ASICON			;ARG
AS3MISSILEICON
	.LONG	MISSILE_3		;IMAGE
	.WORD	ICONTIME

ASICON
	.LONG	1
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIPALCONSTSAVE+2	;SAVE CONST:PAL & SET TO WHITE
	.LONG	WHITEPALCONST

	.LONG	1
	.WORD	M_AFUNC|ICONTIME*2
	.LONG	ANIPALCONSTRESTORE	;RESTORE CONST:PAL

	.LONG	1
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIPALCONSTFIRST+2	;COLOR OF PLAYER
	.LONG	WHITEPALCONST

	.LONG	1
	.WORD	M_AFUNC|ICONTIME*2
	.LONG	ANIPALCONSTRESTORE	;RESTORE CONST:PAL

	.LONG	1
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIPALCONSTFIRST+2	;COLOR OF PLAYER
	.LONG	WHITEPALCONST

	.LONG	1
	.WORD	M_AFUNC|ICONTIME*2
	.LONG	ANIPALCONSTRESTORE	;RESTORE CONST:PAL

	.LONG	1			;ON & SET A BIG DELAY
	.WORD	M_AFUNC|1
	.LONG	ANIONTIME4+4		;FUNC:ARGCOUNT IN WORDS
	.WORD	ONESECOND*4 		;TIME0
	.WORD	ONESECOND*6		;TIME1
	.WORD	ONESECOND*8		;TIME2
	.WORD	ONESECOND*10		;TIME3

	.LONG	1			;OFF
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIOFF		

	.LONG	1			;ON
	.WORD	M_AFUNC|ICONTIME*2
	.LONG	ANION		

	.LONG	1			;OFF
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIOFF		

	.LONG	1			;ON
	.WORD	M_AFUNC|ICONTIME*2
	.LONG	ANION

	.LONG	1			;OFF
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIOFF		

	.LONG	1			;ON
	.WORD	M_AFUNC|ICONTIME*2
	.LONG	ANION

	.LONG	1			;OFF
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIOFF		

	.LONG	1			;ON
	.WORD	M_AFUNC|ICONTIME*2
	.LONG	ANION


	.LONG	1			;OFF IN A BIG WAY
	.WORD	M_AFUNC|1
	.LONG	ANIKILLPOWERUP

	.LONG	0

***
*** SENDING ICONS TO SCORE BOX --------------------------------------------
***

TOSCORETIME	EQU	4
ASTOSCOREBOX 	;-- WHEN A PLAYER/DRONE WITH A SCORE BOX PICKS UP AN ICON
	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONSTSAVE+2	;SAVE CONST:PAL & SET TO WHITE
	.LONG	WHITEPALCONST

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME	;LOOP HERE
	.LONG	ANILOOPHERE

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONSTRESTORE	;RESTORE CONST:PAL

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONSTICONFIRST	;COLOR OF PLAYER

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANITOSCOREBOX	 	;CHECK IF AT DEST

	.LONG	0

ASTOSCORENOBOX	;-- WHEN DRONES THAT DONT HAVE A SCORE BOX PICK UP AN ICON
	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONSTSAVE+2	;SAVE CONST:PAL & SET TO WHITE
	.LONG	WHITEPALCONST

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME	;LOOP HERE
	.LONG	ANILOOPHERE

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONSTRESTORE	;RESTORE CONST:PAL

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONSTICONFIRST+2	;COLOR OF PLAYER
	.LONG	WHITEPALCONST

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANITOSCORENOBOX	 	;CHECK IF AT DEST

	.LONG	0

ASTOSCOREBOXSOLID	;-- A SOLID COLORED ICON IS SENT TOWARD A SCORE BOX
	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONSTFIRST+2
	.LONG	WHITEPALCONST		;WHITE

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANILOOPHERE		;LOOP
	
	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONSTICON		;COLOR OF PLAYER

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONST+2
	.LONG	WHITEPALCONST		;WHITE

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANITOSCOREBOX	 	;CHECK IF AT DEST

	.LONG	0

ASTOSCORENOBOXSOLID	;-- A SOLID COLORED ICON IS SENT OFF SCREEN
	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONSTFIRST+2
	.LONG	WHITEPALCONST		;WHITE

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANILOOPHERE		;LOOP
	
	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONSTICON		;COLOR OF PLAYER

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANIPALCONST+2
	.LONG	WHITEPALCONST		;WHITE

	.LONG	1
	.WORD	M_AFUNC|TOSCORETIME
	.LONG	ANITOSCORENOBOX	 	;CHECK IF AT DEST

	.LONG	0
	
***
*** ----------------------------------------------------------------------
***

MINETIME	EQU	3
ASLMINE
	.LONG	MINE1
	.WORD	M_AFUNC|MINETIME
	.LONG	ANICYCLE+3		;WORD ARGCOUNT
	.LONG	0101000DH		;VEL.8:COUNT:8:00.8:FIRST.8
	.WORD	6			;TIME
	.LONG	MINE2
	.WORD	MINETIME
	.LONG	MINE3
	.WORD	MINETIME
	.LONG	MINE4
	.WORD	MINETIME
	.LONG	MINE5
	.WORD	MINETIME
	.LONG	MINE6
	.WORD	MINETIME
	.LONG	MINE7
	.WORD	MINETIME
	.LONG	MINE8
	.WORD	MINETIME
	.LONG	MINE9
	.WORD	MINETIME
	.LONG	MINE10
	.WORD	MINETIME*2
	.LONG	MINE11
	;.WORD	MINETIME*2
	;.LONG	MINE12
	;.WORD	MINETIME*3
	;.LONG	MINE13
	;.WORD	MINETIME*3
	;.LONG	MINE14
	.WORD	M_AFUNC|1
	.LONG	ANIPULL			;NO MORE ANIM
	.LONG	0

FISH1TIME	EQU	4
FISH2TIME	EQU	5
FISH3TIME	EQU	7
FISH4TIME	EQU	5

ASFISH1
	.LONG	fishy1
	.WORD	FISH1TIME
	.LONG	fishy2
	.WORD	FISH1TIME
	.LONG	fishy3
	.WORD	FISH1TIME
	.LONG	fishy4
	.WORD	FISH1TIME
	.LONG	fishy5
	.WORD	FISH1TIME
	.LONG	fishy6
	.WORD	FISH1TIME
	.LONG	fishy7
	.WORD	FISH1TIME
	.LONG	0

ASFISH2
	.LONG	fishy8
	.WORD	FISH2TIME*2
	.LONG	fishy9
	.WORD	FISH2TIME
	.LONG	fishy10
	.WORD	FISH2TIME
	.LONG	fishy9
	.WORD	FISH2TIME
	.LONG	0

ASFISH3
	.LONG	fishy11
	.WORD	FISH3TIME
	.LONG	fishy12
	.WORD	FISH3TIME
	.LONG	fishy11
	.WORD	FISH3TIME
	.LONG	fishy13
	.WORD	FISH3TIME
	.LONG	0

ASFISH4
	.LONG	fishy1
	.WORD	FISH4TIME
	.LONG	fishy8
	.WORD	FISH4TIME
	.LONG	fishy14
	.WORD	FISH4TIME
	.LONG	fishy15
	.WORD	FISH4TIME
	.LONG	fishy16
	.WORD	FISH4TIME
	.LONG	fishy17
	.WORD	FISH4TIME
	.LONG	fishy18
	.WORD	FISH4TIME
	.LONG	fishy19
	.WORD	FISH4TIME
	.LONG	0

ROCKTIME	EQU	4
ASROCKLARGE
	.LONG	rockl1
	.WORD	ROCKTIME
	.LONG	rockl2
	.WORD	ROCKTIME
	.LONG	rockl3
	.WORD	ROCKTIME
	.LONG	rockl4
	.WORD	ROCKTIME
	.LONG	rockl5
	.WORD	ROCKTIME
	.LONG	rockl6
	.WORD	ROCKTIME
	.LONG	rockl7
	.WORD	ROCKTIME
	.LONG	rockl8
	.WORD	ROCKTIME
	.LONG	rockl9
	.WORD	ROCKTIME
	.LONG	0

ASROCKMEDIUM
	.LONG	rockm1
	.WORD	ROCKTIME
	.LONG	rockm2
	.WORD	ROCKTIME
	.LONG	rockm3
	.WORD	ROCKTIME
	.LONG	rockm4
	.WORD	ROCKTIME
	.LONG	rockm5
	.WORD	ROCKTIME
	.LONG	rockm6
	.WORD	ROCKTIME
	.LONG	rockm7
	.WORD	ROCKTIME
	.LONG	0


ASROCKSMALL
	.LONG	rocks1
	.WORD	ROCKTIME
	.LONG	rocks2
	.WORD	ROCKTIME
	.LONG	rocks3
	.WORD	ROCKTIME
	.LONG	rocks4
	.WORD	ROCKTIME
	.LONG	rocks5
	.WORD	ROCKTIME
	.LONG	rocks6
	.WORD	ROCKTIME
	.LONG	0

ASFLAG1
	.LONG	FLAG1	
	.WORD	5
	.LONG	FLAG2	
	.WORD	5
	.LONG	FLAG3	
	.WORD	5
	.LONG	FLAG4	
	.WORD	5
	.LONG	FLAG5	
	.WORD	5
	.LONG	FLAG6	
	.WORD	5
	.LONG	FLAG7	
	.WORD	5
	.LONG	FLAG8	
	.WORD	5

	.LONG	0


ASHITTEST
	.LONG	ARROW
	.WORD	M_AFUNC|1
	.LONG	ANILOOPHERE
	
	.LONG	1
	.WORD	M_AFUNC|1
	.LONG	ANIHITTEST

	.LONG	0

ASFLASHKILL
	.LONG	1			;OFF
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIOFF		

	.LONG	1			;OFF
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANION		
	
	.LONG	1			;OFF
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANIOFF		

	.LONG	1			;OFF
	.WORD	M_AFUNC|ICONTIME
	.LONG	ANION		

ASKILL
	.LONG	1
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0		;script end

		

***
*** FLYING PARTS -----------------------------------------------------------
***

**
** ASFLYLANDKILL 
**
** REQUIRES SPECIAL SETUP:
** - SET ANIMFRM TO THIS, SET ANIMSCR TO OBJ ANIM
**   WHEN ANIMP RUNS THROUGH THIS ANIMSCRIPT IT WILL RESET TO THE OBJ ANIM
** - SET OFLYBITS
**
** JFL 16 FEB 93
**
ASFLYLANDKILL
	.LONG	1
	.WORD	M_AFUNC|1
	.LONG	ANIFLYLANDKILL

	.LONG	0		;END

***
*** --------------------------------------------------------------------
***

ASFONZ
	.LONG	FONZ1
	.WORD	MISCTIME
	.LONG	FONZ2
	.WORD	MISCTIME
	.LONG	FONZ3
	.WORD	MISCTIME
	.LONG	FONZ4
	.WORD	MISCTIME
	.LONG	FONZ5
	.WORD	MISCTIME
	.LONG	FONZ6
	.WORD	MISCTIME
	.LONG	0
	
ASGARTH
	.LONG	GARTH1
	.WORD	MISCTIME
	.LONG	GARTH2
	.WORD	MISCTIME
	.LONG	GARTH3
	.WORD	MISCTIME
	.LONG	GARTH4
	.WORD	MISCTIME
	.LONG	GARTH5
	.WORD	MISCTIME
	.LONG	GARTH6
	.WORD	MISCTIME
	.LONG	GARTH7
	.WORD	MISCTIME
	.LONG	GARTH8
	.WORD	MISCTIME
	.LONG	0


***
*** --------------------------------------------------------------------
***

**
** PART ANIMATIONS -- MUST START WITH IMAGE!!!
**

MISCTIME	EQU	3

ASMUFF
	.LONG	muff1
	.WORD	MISCTIME
	.LONG	muff2
	.WORD	MISCTIME
	.LONG	muff3
	.WORD	MISCTIME
	.LONG	muff4
	.WORD	MISCTIME
	.LONG	muff5
	.WORD	MISCTIME
	.LONG	muff6
	.WORD	MISCTIME
	.LONG	muff7
	.WORD	MISCTIME
	.LONG	muff8
	.WORD	MISCTIME
	.LONG	muff9
	.WORD	MISCTIME
	.LONG	muff10
	.WORD	MISCTIME
	.LONG	0
ASPIST
	.LONG	pist1
	.WORD	MISCTIME
	.LONG	pist2
	.WORD	MISCTIME
	.LONG	pist3
	.WORD	MISCTIME
	.LONG	pist4
	.WORD	MISCTIME
	.LONG	pist5
	.WORD	MISCTIME
	.LONG	pist6
	.WORD	MISCTIME
	.LONG	pist7
	.WORD	MISCTIME
	.LONG	0
ASDICE
	.LONG	dice1
	.WORD	MISCTIME
	.LONG	dice2
	.WORD	MISCTIME
	.LONG	dice3
	.WORD	MISCTIME
	.LONG	dice4
	.WORD	MISCTIME
	.LONG	dice5
	.WORD	MISCTIME
	.LONG	dice6
	.WORD	MISCTIME
	.LONG	dice7
	.WORD	MISCTIME
	.LONG	0
ASSEATA
	.LONG	seatA1
	.WORD	MISCTIME
	.LONG	seatA2
	.WORD	MISCTIME
	.LONG	seatA3
	.WORD	MISCTIME
	.LONG	seatA4
	.WORD	MISCTIME
	.LONG	seatA5
	.WORD	MISCTIME
	.LONG	seatA6
	.WORD	MISCTIME
	.LONG	seatA7
	.WORD	MISCTIME
	.LONG	seatA8
	.WORD	MISCTIME
	.LONG	0
ASSEATB
	.LONG	seatB1
	.WORD	MISCTIME
	.LONG	seatB2
	.WORD	MISCTIME
	.LONG	seatB3
	.WORD	MISCTIME
	.LONG	seatB4
	.WORD	MISCTIME
	.LONG	seatB5
	.WORD	MISCTIME
	.LONG	seatB6
	.WORD	MISCTIME
	.LONG	seatB7
	.WORD	MISCTIME
	.LONG	seatB8
	.WORD	MISCTIME
	.LONG	seatB9
	.WORD	MISCTIME
	.LONG	0
ASCARBUR
	.LONG	carbur1
	.WORD	MISCTIME
	.LONG	carbur2
	.WORD	MISCTIME
	.LONG	carbur3
	.WORD	MISCTIME
	.LONG	carbur4
	.WORD	MISCTIME
	.LONG	carbur5
	.WORD	MISCTIME
	.LONG	carbur6
	.WORD	MISCTIME
	.LONG	carbur7
	.WORD	MISCTIME
	.LONG	carbur8
	.WORD	MISCTIME
	.LONG	0
ASSTEER
	.LONG	steer1
	.WORD	MISCTIME
	.LONG	steer2
	.WORD	MISCTIME
	.LONG	steer3
	.WORD	MISCTIME
	.LONG	steer4
	.WORD	MISCTIME
	.LONG	steer5
	.WORD	MISCTIME
	.LONG	steer6
	.WORD	MISCTIME
	.LONG	steer7
	.WORD	MISCTIME
	.LONG	steer8
	.WORD	MISCTIME
	.LONG	steer9
	.WORD	MISCTIME
	.LONG	steer10
	.WORD	MISCTIME
	.LONG	0
ASBUMPERA
	.LONG	bumperA1
	.WORD	MISCTIME
	.LONG	bumperA2
	.WORD	MISCTIME
	.LONG	bumperA3
	.WORD	MISCTIME
	.LONG	bumperA4
	.WORD	MISCTIME
	.LONG	bumperA5
	.WORD	MISCTIME
	.LONG	bumperA6
	.WORD	MISCTIME
	.LONG	bumperA7
	.WORD	MISCTIME
	.LONG	bumperA8
	.WORD	MISCTIME
	.LONG	0
ASBUMPERB
	.LONG	bumperB1
	.WORD	MISCTIME
	.LONG	bumperB2
	.WORD	MISCTIME
	.LONG	bumperB3
	.WORD	MISCTIME
	.LONG	bumperB4
	.WORD	MISCTIME
	.LONG	bumperB5
	.WORD	MISCTIME
	.LONG	bumperB6
	.WORD	MISCTIME
	.LONG	bumperB7
	.WORD	MISCTIME
	.LONG	0
ASDISTRBA
	.LONG	distrbA1
	.WORD	MISCTIME
	.LONG	distrbA2
	.WORD	MISCTIME
	.LONG	distrbA3
	.WORD	MISCTIME
	.LONG	distrbA4
	.WORD	MISCTIME
	.LONG	distrbA5
	.WORD	MISCTIME
	.LONG	distrbA6
	.WORD	MISCTIME
	.LONG	distrbA7
	.WORD	MISCTIME
	.LONG	0
ASDISTRBB
	.LONG	distrbB1
	.WORD	MISCTIME
	.LONG	distrbB2
	.WORD	MISCTIME
	.LONG	distrbB3
	.WORD	MISCTIME
	.LONG	distrbB4
	.WORD	MISCTIME
	.LONG	distrbB5
	.WORD	MISCTIME
	.LONG	distrbB6
	.WORD	MISCTIME
	.LONG	distrbB7
	.WORD	MISCTIME
	.LONG	distrbB8
	.WORD	MISCTIME
	.LONG	0
ASBELT
	.LONG	belt1
	.WORD	MISCTIME
	.LONG	belt2
	.WORD	MISCTIME
	.LONG	belt3
	.WORD	MISCTIME
	.LONG	belt4
	.WORD	MISCTIME
	.LONG	belt5
	.WORD	MISCTIME
	.LONG	belt6
	.WORD	MISCTIME
	.LONG	0
ASTHINGA
	.LONG	thingA1
	.WORD	MISCTIME
	.LONG	thingA2
	.WORD	MISCTIME
	.LONG	thingA3
	.WORD	MISCTIME
	.LONG	thingA4
	.WORD	MISCTIME
	.LONG	thingA5
	.WORD	MISCTIME
	.LONG	thingA6
	.WORD	MISCTIME
	.LONG	thingA7
	.WORD	MISCTIME
	.LONG	thingA8
	.WORD	MISCTIME
	.LONG	0
ASTHINGB
	.LONG	thingB1
	.WORD	MISCTIME
	.LONG	thingB2
	.WORD	MISCTIME
	.LONG	thingB3
	.WORD	MISCTIME
	.LONG	thingB4
	.WORD	MISCTIME
	.LONG	thingB5
	.WORD	MISCTIME
	.LONG	thingB6
	.WORD	MISCTIME
	.LONG	thingB7
	.WORD	MISCTIME
	.LONG	thingB8
	.WORD	MISCTIME
	.LONG	0
ASMIRROR
	.LONG	mirror1
	.WORD	MISCTIME
	.LONG	mirror2
	.WORD	MISCTIME
	.LONG	mirror3
	.WORD	MISCTIME
	.LONG	mirror4
	.WORD	MISCTIME
	.LONG	mirror5
	.WORD	MISCTIME
	.LONG	mirror6
	.WORD	MISCTIME
	.LONG	mirror7
	.WORD	MISCTIME
	.LONG	mirror8
	.WORD	MISCTIME
	.LONG	0
ASFTPEDAL
	.LONG	ftpedal1
	.WORD	MISCTIME
	.LONG	ftpedal2
	.WORD	MISCTIME
	.LONG	ftpedal3
	.WORD	MISCTIME
	.LONG	ftpedal4
	.WORD	MISCTIME
	.LONG	ftpedal5
	.WORD	MISCTIME
	.LONG	ftpedal6
	.WORD	MISCTIME
	.LONG	ftpedal7
	.WORD	MISCTIME
	.LONG	ftpedal8
	.WORD	MISCTIME
	.LONG	0
ASSPARKA
	.LONG	sparkA1
	.WORD	MISCTIME
	.LONG	sparkA2
	.WORD	MISCTIME
	.LONG	sparkA3
	.WORD	MISCTIME
	.LONG	sparkA4
	.WORD	MISCTIME
	.LONG	sparkA5
	.WORD	MISCTIME
	.LONG	sparkA6
	.WORD	MISCTIME
	.LONG	sparkA7
	.WORD	MISCTIME
	.LONG	sparkA8
	.WORD	MISCTIME
	.LONG	0
ASSPARKB
	.LONG	sparkB1
	.WORD	MISCTIME
	.LONG	sparkB2
	.WORD	MISCTIME
	.LONG	sparkB3
	.WORD	MISCTIME
	.LONG	sparkB4
	.WORD	MISCTIME
	.LONG	sparkB5
	.WORD	MISCTIME
	.LONG	sparkB6
	.WORD	MISCTIME
	.LONG	sparkB7
	.WORD	MISCTIME
	.LONG	sparkB8
	.WORD	MISCTIME
	.LONG	0
ASTIREA
	.LONG	tireA1
	.WORD	MISCTIME
	.LONG	tireA2
	.WORD	MISCTIME
	.LONG	tireA3
	.WORD	MISCTIME
	.LONG	tireA4
	.WORD	MISCTIME
	.LONG	tireA5
	.WORD	MISCTIME
	.LONG	tireA6
	.WORD	MISCTIME
	.LONG	tireA7
	.WORD	MISCTIME
	.LONG	tireA8
	.WORD	MISCTIME
	.LONG	0
ASTIREB
	.LONG	tireB1
	.WORD	MISCTIME
	.LONG	tireB2
	.WORD	MISCTIME
	.LONG	tireB3
	.WORD	MISCTIME
	.LONG	tireB4
	.WORD	MISCTIME
	.LONG	tireB5
	.WORD	MISCTIME
	.LONG	tireB6
	.WORD	MISCTIME
	.LONG	0
ASWINGORN
	.LONG	wingorn1
	.WORD	MISCTIME
	.LONG	wingorn2
	.WORD	MISCTIME
	.LONG	wingorn3
	.WORD	MISCTIME
	.LONG	wingorn4
	.WORD	MISCTIME
	.LONG	wingorn5
	.WORD	MISCTIME
	.LONG	wingorn6
	.WORD	MISCTIME
	.LONG	wingorn7
	.WORD	MISCTIME
	.LONG	wingorn8
	.WORD	MISCTIME
	.LONG	0
ASWHEELA
	.LONG	wheel1
	.WORD	MISCTIME
	.LONG	wheel2
	.WORD	MISCTIME
	.LONG	wheel3
	.WORD	MISCTIME
	.LONG	wheel4
	.WORD	MISCTIME
	.LONG	wheel5
	.WORD	MISCTIME
	.LONG	wheel6
	.WORD	MISCTIME
	.LONG	wheel3
	.WORD	MISCTIME
	.LONG	wheel7
	.WORD	MISCTIME
	.LONG	0
ASWHEELB
	.LONG	wheel1
	.WORD	MISCTIME
	.LONG	wheel8
	.WORD	MISCTIME
	.LONG	wheel9
	.WORD	MISCTIME
	.LONG	wheel10
	.WORD	MISCTIME
	.LONG	wheel11
	.WORD	MISCTIME
	.LONG	wheel5
	.WORD	MISCTIME
	.LONG	wheel12
	.WORD	MISCTIME
	.LONG	wheel13
	.WORD	MISCTIME
	.LONG	wheel10
	.WORD	MISCTIME
	.LONG	wheel14
	.WORD	MISCTIME
	.LONG	0
ASFILTER
	.LONG	filter1
	.WORD	MISCTIME
	.LONG	filter2
	.WORD	MISCTIME
	.LONG	filter3
	.WORD	MISCTIME
	.LONG	filter4
	.WORD	MISCTIME
	.LONG	filter5
	.WORD	MISCTIME
	.LONG	filter6
	.WORD	MISCTIME
	.LONG	0
ASPLATE
	.LONG	plate1
	.WORD	MISCTIME
	.LONG	plate2
	.WORD	MISCTIME
	.LONG	plate3
	.WORD	MISCTIME
	.LONG	plate4
	.WORD	MISCTIME
	.LONG	plate5
	.WORD	MISCTIME
	.LONG	plate6
	.WORD	MISCTIME
	.LONG	plate7
	.WORD	MISCTIME
	.LONG	plate8
	.WORD	MISCTIME
	.LONG	plate9
	.WORD	MISCTIME
	.LONG	0
ASHORNORN
	.LONG	hornorn1
	.WORD	MISCTIME
	.LONG	hornorn2
	.WORD	MISCTIME
	.LONG	hornorn3
	.WORD	MISCTIME
	.LONG	hornorn4
	.WORD	MISCTIME
	.LONG	hornorn5
	.WORD	MISCTIME
	.LONG	hornorn6
	.WORD	MISCTIME
	.LONG	hornorn7
	.WORD	MISCTIME
	.LONG	hornorn8
	.WORD	MISCTIME
	.LONG	0
ASRADIATE
	.LONG	radiate1
	.WORD	MISCTIME
	.LONG	radiate2
	.WORD	MISCTIME
	.LONG	radiate3
	.WORD	MISCTIME
	.LONG	radiate4
	.WORD	MISCTIME
	.LONG	radiate5
	.WORD	MISCTIME
	.LONG	radiate6
	.WORD	MISCTIME
	.LONG	radiate7
	.WORD	MISCTIME
	.LONG	radiate8
	.WORD	MISCTIME
	.LONG	0
ASGASCAN
	.LONG	gascan1
	.WORD	MISCTIME
	.LONG	gascan2
	.WORD	MISCTIME
	.LONG	gascan3
	.WORD	MISCTIME
	.LONG	gascan4
	.WORD	MISCTIME
	.LONG	gascan5
	.WORD	MISCTIME
	.LONG	gascan6
	.WORD	MISCTIME
	.LONG	gascan7
	.WORD	MISCTIME
	.LONG	gascan8
	.WORD	MISCTIME
	.LONG	gascan9
	.WORD	MISCTIME
	.LONG	0
ASMISCA
	.LONG	MISCa_1
	.WORD	MISCTIME
	.LONG	MISCa_2
	.WORD	MISCTIME
	.LONG	MISCa_3
	.WORD	MISCTIME
	.LONG	MISCa_4
	.WORD	MISCTIME
	.LONG	MISCa_5
	.WORD	MISCTIME
	.LONG	MISCa_6
	.WORD	MISCTIME
	.LONG	0

ASMISCB
	.LONG	MISCb_1
	.WORD	MISCTIME
	.LONG	MISCb_2
	.WORD	MISCTIME
	.LONG	MISCb_3
	.WORD	MISCTIME
	.LONG	MISCb_4
	.WORD	MISCTIME
	.LONG	MISCb_5
	.WORD	MISCTIME
	.LONG	MISCb_6
	.WORD	MISCTIME
	.LONG	MISCb_7
	.WORD	MISCTIME
	.LONG	MISCb_8
	.WORD	MISCTIME
	.LONG	MISCb_9
	.WORD	MISCTIME
	.LONG	0


***
*** ---------------------------------------------------------------------
***

PICKTIME	EQU	8
TROPHYTIME	EQU	6
PRSTARTTIME	EQU	20

ASPRSTART
	.LONG	PRSTART
	.WORD	PRSTARTTIME

	.LONG	1
	.WORD	M_AFUNC|1
	.LONG	ANILOOPHERE

	.LONG	1
	.WORD	M_AFUNC|PRSTARTTIME
	.LONG	ANIONOFF

	.LONG	0

ASDEADMISL	;-- WHEN LEFT OVER MISSLE FLY OUT OF A DYING CAR
	.LONG	1
	.WORD	M_AFUNC|1
	.LONG	ANIDEADMISL	;KILLS ANIM TOO

	.LONG	0

TIMEBOOM	EQU	2

ASCARFIRE
	.LONG	SMBOOM1
	.WORD	TIMEBOOM*2
	.LONG	SMBOOM2
	.WORD	TIMEBOOM*2
	.LONG	SMBOOM3
	.WORD	TIMEBOOM*2
	.LONG	SMBOOM4
	.WORD	TIMEBOOM*2
	.LONG	0

ASDEATHBOOM
	.LONG	EXPL_1
	.WORD	M_AFUNC|1
	.LONG	ANIDEATHBOOM

	.LONG	1		;NO IMG
	.WORD	M_AFUNC|1	;FLAGS:FRAMES
	.LONG	ANISPAWN+4	;THIS FUNCTION PLUS 2 LONG ARGS
	.LONG	ASDEATHBOOM2	;ANIM SCRIPT / ARG2
	.LONG	ASIDEATHBOOM2	;ANISPAWN INIT FUNCTION	/ ARG3

	.LONG	1		;NO IMG
	.WORD	M_AFUNC|1	;FLAGS:FRAMES
	.LONG	ANISPAWN+4	;THIS FUNCTION PLUS 2 LONG ARGS
	.LONG	ASDEATHBOOM2	;ANIM SCRIPT / ARG2
	.LONG	ASIDEATHBOOM2	;ANISPAWN INIT FUNCTION	/ ARG3

ASDEATHBOOM2
	.LONG	EXPL_2
	.WORD	1

	.LONG	1
	.WORD	M_AFUNC|1
	.LONG	ANIOFF	   	;TURN OFF SO EXPLOSION DOESNT DELAY

	.LONG	1
	.WORD	M_AFUNC|1
	.LONG	ANITIME4+4	;PICK DELAY RANDOMLY FROM THE FOLLOWING 4
	.WORD	TIMEBOOM*16
	.WORD	TIMEBOOM*32
	.WORD	TIMEBOOM*8
	.WORD	TIMEBOOM

	.LONG	1
	.WORD	M_AFUNC|TIMEBOOM*2
	.LONG	ANION	      	;TURN ON

	.LONG	EXPL_3
	.WORD	TIMEBOOM*2
	.LONG	EXPL_4
	.WORD	TIMEBOOM*2
	.LONG	EXPL_5
	.WORD	TIMEBOOM*2
	.LONG	EXPL_6
	.WORD	M_AFUNC|1
	.LONG	ANITIME4+4	;PICK DELAY RANDOMLY FROM THE FOLLOWING 4
	.WORD	TIMEBOOM*3
	.WORD	TIMEBOOM*2
	.WORD	TIMEBOOM*3
	.WORD	TIMEBOOM*2

	.LONG	EXPL_7
	.WORD	TIMEBOOM*3
	.LONG	EXPL_8
	.WORD	TIMEBOOM*3
	.LONG	EXPL_9
	.WORD	TIMEBOOM*4
	.LONG	EXPL_10
	.WORD	TIMEBOOM*2

	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0

ASDEFENSEBOOM
	.LONG	DEFMIS_1A
	.WORD	TIMEBOOM
	.LONG	DEFMIS_2A
	.WORD	TIMEBOOM
	.LONG	DEFMIS_3A
	.WORD	TIMEBOOM
	.LONG	DEFMIS_4A
	.WORD	TIMEBOOM
	.LONG	DEFMIS_4
	.WORD	TIMEBOOM

	.LONG	1		;FRAME
	.WORD	M_AFUNC|1
  	.LONG	ANIOCVECT	;CALL OCVECT -- EXPLODE MISSILES

	.LONG	DEFMIS_5
	.WORD	TIMEBOOM
	.LONG	DEFMIS_5A
	.WORD	TIMEBOOM
	.LONG	DEFMIS_5
	.WORD	TIMEBOOM

	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC

	.LONG	0

ASMISLFFBOOM
	.LONG	SMBOOM1
	.WORD	TIMEBOOM*2
	.LONG	SMBOOM2
	.WORD	TIMEBOOM*2
	.LONG	SMBOOM3
	.WORD	TIMEBOOM*2

	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0

ASMISLBOOM
	.LONG	LGBOOM1
	.WORD	TIMEBOOM*2

	.LONG	1		;NO IMG
	.WORD	M_AFUNC|1		;FLAGS:FRAMES
	.LONG	ANISETSCALETYPE+1 ;FUNC:ARGCOUNT	
	.WORD	STYPZOFF+40

	.LONG	LGBOOM2
	.WORD	TIMEBOOM*2
	.LONG	LGBOOM3
	.WORD	TIMEBOOM*2
	.LONG	LGBOOM4
	.WORD	TIMEBOOM*2
	.LONG	LGBOOM5
	.WORD	TIMEBOOM*2
	.LONG	LGBOOM6
	.WORD	TIMEBOOM*3
	.LONG	LGBOOM7
	.WORD	TIMEBOOM*3
	.LONG	LGBOOM8
	.WORD	TIMEBOOM*3
	.LONG	LGBOOM9
	.WORD	TIMEBOOM*4
	.LONG	LGBOOM10
	.WORD	TIMEBOOM*2

	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0

ASLMINEBOOM
	.LONG	LGBOOM1
	.WORD	M_AFUNC|TIMEBOOM*2
	.LONG	ANISETSCALETYPE+1 	;FUNC:ARGCOUNT	
	.WORD	STYPELMINE

	.LONG	LGBOOM2
	.WORD	TIMEBOOM*2
	.LONG	LGBOOM3
	.WORD	TIMEBOOM*2
	.LONG	LGBOOM4
	.WORD	TIMEBOOM*2
	.LONG	LGBOOM5
	.WORD	TIMEBOOM*2
	.LONG	LGBOOM6
	.WORD	TIMEBOOM*3
	.LONG	LGBOOM7
	.WORD	TIMEBOOM*3
	.LONG	LGBOOM8
	.WORD	TIMEBOOM*3
	.LONG	LGBOOM9
	.WORD	TIMEBOOM*4
	.LONG	LGBOOM10
	.WORD	TIMEBOOM*2

	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0

***
*** DIRECTIONAL ANIMATIONS -----------------------------------------------
***

**
** DIRECTIONAL ANIMATION TBL
** SEE DRA.I FOR DA STRUCT
**
** !!! WARNING !!!
** ALL OF THE ANIMS MUST MUST MUST BE IN SYNC WITH EACHOTHER
** I.E. ALL IMAGE, TIME, & FUNCTIONS MUST MIRROR EACHOTER OFFSET-WISE
** WHEN THE CAR CHANGES DIR, THE OFFSET OF THE CURRENT ANIM IS USED
** AS THE OFFSET FOR THE NEW ANIM (USING ANIMSCR-ANIMFRM FOR THE OFFSET)
** !!! WARNING !!!
**
** JFL 24 NOV 92
** JFL 14 APR 93
**
DIRANIMTURBO
	.LONG	ASTURBOD+M_HF
	.LONG	ASTURBOD+M_HF
	.LONG	ASTURBOE+M_HF
	.LONG	ASTURBOE+M_HF
	.LONG	ASTURBOE+M_HF
	.LONG	ASTURBOF+M_HF
	.LONG	ASTURBOF+M_HF
	.LONG	ASTURBOF+M_HF
	.LONG	ASTURBOG
	.LONG	ASTURBOF
	.LONG	ASTURBOF
	.LONG	ASTURBOF
	.LONG	ASTURBOE
	.LONG	ASTURBOE
	.LONG	ASTURBOE
	.LONG	ASTURBOD
	.LONG	ASTURBOD
	.LONG	ASTURBOD
	.LONG	ASTURBOC
	.LONG	ASTURBOC
	.LONG	ASTURBOC
	.LONG	ASTURBOB
	.LONG	ASTURBOB
	.LONG	ASTURBOB
	.LONG	ASTURBOA
	.LONG	ASTURBOB+M_HF
	.LONG	ASTURBOB+M_HF
	.LONG	ASTURBOB+M_HF
	.LONG	ASTURBOC+M_HF
	.LONG	ASTURBOC+M_HF
	.LONG	ASTURBOC+M_HF
	.LONG	ASTURBOD+M_HF

TURBTIME	EQU	2
ASTURBOA
	.LONG	TURB_A1
	.WORD	TURBTIME
	.LONG	TURB_A2
	.WORD	TURBTIME
	.LONG	TURB_A3
	.WORD	TURBTIME
	.LONG	TURB_A4
	.WORD	TURBTIME
	.LONG	TURB_A5
	.WORD	TURBTIME
	.LONG	TURB_A6
	.WORD	TURBTIME
	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0

ASTURBOB
	.LONG	TURB_B1
	.WORD	TURBTIME
	.LONG	TURB_B2
	.WORD	TURBTIME
	.LONG	TURB_B3
	.WORD	TURBTIME
	.LONG	TURB_B4
	.WORD	TURBTIME
	.LONG	TURB_B5
	.WORD	TURBTIME
	.LONG	TURB_B6
	.WORD	TURBTIME
	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0

ASTURBOC
	.LONG	TURB_C1
	.WORD	TURBTIME
	.LONG	TURB_C2
	.WORD	TURBTIME
	.LONG	TURB_C3
	.WORD	TURBTIME
	.LONG	TURB_C4
	.WORD	TURBTIME
	.LONG	TURB_C5
	.WORD	TURBTIME
	.LONG	TURB_C6
	.WORD	TURBTIME
	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0

ASTURBOD
	.LONG	TURB_D1
	.WORD	TURBTIME
	.LONG	TURB_D2
	.WORD	TURBTIME
	.LONG	TURB_D3
	.WORD	TURBTIME
	.LONG	TURB_D4
	.WORD	TURBTIME
	.LONG	TURB_D5
	.WORD	TURBTIME
	.LONG	TURB_D6
	.WORD	TURBTIME
	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0

ASTURBOE
	.LONG	TURB_E1
	.WORD	TURBTIME
	.LONG	TURB_E2
	.WORD	TURBTIME
	.LONG	TURB_E3
	.WORD	TURBTIME
	.LONG	TURB_E4
	.WORD	TURBTIME
	.LONG	TURB_E5
	.WORD	TURBTIME
	.LONG	TURB_E6
	.WORD	TURBTIME
	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0

ASTURBOF
	.LONG	TURB_F1
	.WORD	TURBTIME
	.LONG	TURB_F2
	.WORD	TURBTIME
	.LONG	TURB_F3
	.WORD	TURBTIME
	.LONG	TURB_F4
	.WORD	TURBTIME
	.LONG	TURB_F5
	.WORD	TURBTIME
	.LONG	TURB_F6
	.WORD	TURBTIME
	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0

ASTURBOG
	.LONG	TURB_G1
	.WORD	TURBTIME
	.LONG	TURB_G2
	.WORD	TURBTIME
	.LONG	TURB_G3
	.WORD	TURBTIME
	.LONG	TURB_G4
	.WORD	TURBTIME
	.LONG	TURB_G5
	.WORD	TURBTIME
	.LONG	TURB_G6
	.WORD	TURBTIME
	.LONG	1		;FRAME
	.WORD	M_AFUNC|1		;
	.LONG	ANIKILL		;FUNC
	.LONG	0

***
*** MISC PART TBLS --------------------------------------------------------
***

**
** .WORD COUNTMASK
** .LONG ANIMSCRIPT
**
** JFL 12 FEB 93
**

**
** FOUR
**

MPFOUR0
MPFOUR3
MPFOUR4
	;FRONT HITS
	.WORD	0FH ;COUNT MASK
	.LONG	ASPIST,ASCARBUR,ASDISTRBA,ASDISTRBB,ASBELT,ASSPARKA
	.LONG	ASSPARKB,ASFILTER,ASRADIATE,ASPIST,ASDISTRBA,ASDISTRBB
	.LONG	ASBELT,ASWINGORN,ASHORNORN,ASPIST

MPFOUR1
MPFOUR2
MPFOUR6
	;REAR HITS
	.WORD	07H ;COUNT MASK
	.LONG	ASBUMPERA,ASBUMPERB,ASPLATE,ASGASCAN
	.LONG	ASWHEELA,ASWHEELB,ASWHEELA,ASWHEELB

MPFOUR5
MPFOUR7
	;SIDE HITS
	.WORD	07H ;COUNT MASK
	.LONG	ASMUFF,ASMUFF,ASSEATA,ASSEATB,ASSTEER,ASMIRROR
	.LONG	ASFTPEDAL,ASMIRROR

**
** CHEV
**

MPCHEV0
MPCHEV3
MPCHEV4
	;FRONT HITS
	.WORD	0FH ;COUNT MASK
	.LONG	ASPIST,ASCARBUR,ASDISTRBA,ASDISTRBB,ASBELT,ASSPARKA
	.LONG	ASSPARKB,ASFILTER,ASRADIATE,ASPIST,ASDISTRBA,ASDISTRBB
	.LONG	ASBELT,ASWINGORN,ASHORNORN,ASPIST
MPCHEV1
MPCHEV2
MPCHEV6
	;REAR HITS
	.WORD	07H ;COUNT MASK
	.LONG	ASBUMPERA,ASBUMPERB,ASPLATE,ASGASCAN
	.LONG	ASWHEELA,ASWHEELB,ASWHEELA,ASWHEELB

MPCHEV5
MPCHEV7
	;SIDE HITS
	.WORD	07H ;COUNT MASK
	.LONG	ASMUFF,ASDICE,ASSEATA,ASSEATB,ASSTEER,ASMIRROR
	.LONG	ASFTPEDAL,ASDICE


***
*** AREA HIT TABLES ------------------------------------------------------
***

HITV1	EQU	NODAMAGE-1*(NODAMAGE/8)
HITV2	EQU	NODAMAGE-2*(NODAMAGE/8)
HITV3	EQU	NODAMAGE-3*(NODAMAGE/8)
HITV4	EQU	NODAMAGE-4*(NODAMAGE/8)
HITV5	EQU	NODAMAGE-5*(NODAMAGE/8)
HITV6	EQU	NODAMAGE-6*(NODAMAGE/8)
HITV7	EQU	NODAMAGE-7*(NODAMAGE/8)
HITV8	EQU	1
HITVX	EQU	NODAMAGE

**
** FOUR
**
FOURHITFRONT
	;FRONT HITS
	.IF 0 ;---
	.WORD	HITV3
	.LONG	ASFOURHOOD+M_CDPAL+M_HVF+M_AVEL
	.WORD	M_PTOFF+FOURHOOD
	.WORD	HITV6
	.LONG	ASMISCA+M_HVF+M_CDPAL+M_AVEL
	.WORD	HITV8
	.LONG	ASRADIATE+M_HVF+M_AVEL
	.ENDIF ;0---
	.WORD	0			;TERM

FOURHITMID
	;SIDE HITS
	.IF 0 ;---
	.WORD	HITV3
	.LONG	ASFOURDOOR+M_CDPAL+M_AVEL
	.WORD	M_PTOFF+FOURDOOR
	.WORD	HITV5
	.LONG	ASDICE+M_HVF+M_AVEL
	.WORD	HITV5
	.LONG	ASMIRROR+M_HVF+M_AVEL
	.WORD	HITV6
	.LONG	ASMISCA+M_HVF+M_CDPAL+M_AVEL
	.ENDIF ;0---
	.WORD	0			;TERM

FOURHITBACK
	;REAR HITS
	.IF 0 ;---
	.WORD	HITV3
	.LONG	ASFOURREAR+M_CDPAL+M_AVEL
	.WORD	M_PTOFF+FOURREAR
	.WORD	HITV4
	.LONG	ASMUFF+M_HVF+M_AVEL
	.WORD	HITV6
	.LONG	ASFOURSIDE+M_CDPAL+M_AVEL
	.WORD	M_PTOFF+FOURSIDE
	.WORD	M_PTDEATH ;--- PARTS BELOW COME OFF AT DEATH ---
	.LONG	ASFOURWHEEL+M_HVF+M_AVEL
	.WORD	HITV8
	.LONG	ASFOURWHEEL+M_HVF+M_AVEL
	.WORD	HITV8
	.LONG	ASMISCA+M_HVF+M_CDPAL+M_AVEL
	.WORD	HITV8
	.LONG	ASSTEER+M_HF+M_AVEL
	.WORD	HITV8
	.LONG	ASSEATB+M_HF+M_AVEL
	.ENDIF ;0---
	.WORD	0			;TERM


***
*** ---------------------------------------------------------------------
***

**
** ASDEATHBOOMTBL
** MAP CDDRIVERID TO DEATH ANIM
**
** JFL 16 FEB 93
**
ASDEATHBOOMTBL
	.LONG	ASGARTH+M_HF+M_AVEL
	.LONG	ASFONZ+M_HF+M_AVEL
	.LONG	ASGARTH+M_HF+M_AVEL
	.LONG	ASFONZ+M_HF+M_AVEL
ASDEATHBOOMTBLX

***
*** STATE ANIM SCRIPTS ----------------------------------------------------
***


**
** ASSUME FLAT TO START WITH
**
SASROLLLEFT
	.WORD	STATE_ROLLLEFT
	.WORD	STATE_SIDELEFT
	.WORD	STATE_BELLY
	.WORD	STATE_SIDERIGHT
	.WORD	STATE_ROLLRIGHT
	.WORD	M_SASTERM
SASROLLRIGHT
	.WORD	STATE_ROLLRIGHT
	.WORD	STATE_SIDERIGHT
	.WORD	STATE_BELLY
	.WORD	STATE_SIDELEFT
	.WORD	STATE_ROLLLEFT
	.WORD	M_SASTERM
SASREHIT
SASTOSSROLLLOOP
	.WORD	STATE_ROLLRIGHT
	.WORD	STATE_SIDERIGHT
	.WORD	STATE_BELLY
	.WORD	STATE_SIDELEFT
	.WORD	STATE_ROLLLEFT
	.WORD	STATE_FLAT
	.WORD	M_SASRESET
	.LONG	SASTOSSROLLLOOP
SASROCKUPDOWN
	.WORD	STATE_LOWUP
	.WORD	STATE_FLAT
	.WORD	STATE_LOWDOWN
	.WORD	M_SASTERM
SASROCKDOWNUP
	.WORD	STATE_LOWDOWN
	.WORD	STATE_FLAT
	.WORD	STATE_LOWUP
	.WORD	M_SASTERM
SASROCKBACKA
	.WORD	STATE_LOWUP
	.WORD	STATE_MEDUP
	.WORD	STATE_LOWUP
	.WORD	M_SASTERM
SASROCKFRONTA
	.WORD	STATE_LOWDOWN
	.WORD	STATE_MEDDOWN
	.WORD	STATE_LOWDOWN
	.WORD	M_SASTERM
SASROCKRIGHTA
	.WORD	STATE_ROLLRIGHT
	.WORD	STATE_SIDERIGHT
	.WORD	STATE_ROLLRIGHT
	.WORD	M_SASTERM
SASROCKLEFTA
	.WORD	STATE_ROLLLEFT
	.WORD	STATE_SIDELEFT
	.WORD	STATE_ROLLLEFT
	.WORD	M_SASTERM

**
** CHECKDMAOBJ
** NOTE: TABLE WORKS BACKWARDS!!
**
** JFL 04 MAR 93
**
	.LONG	0D6E41005H	;CHECKSUM
	.LONG	[DMAWNZ,0]	;CTRL:OFST
	.LONG	[20,100]	;DAG
	.LONG	R_1		;IHDR -- WILL BE DEREFENCED TO SAG
	.LONG	[0,0]		;CONST:PAL
	.LONG	[101H,0C1H]	;[101H,0C1H] ;SCALEY:SCALEX
CHECKDMAOBJ
	
	.IF 1 ;PAGE0
CDWIN		EQU	[0FDH,0]
CDSTARTXY	EQU	[0,0]
CDDPYPAGE	EQU	DPYSTRT1
CDDPYPAGE2	EQU	DPYSTRT0
	.ELSE ;PAGE1
CDWIN		EQU	[1FDH,100H]
CDSTARTXY	EQU	[100H,0]
CDDPYPAGE	EQU	DPYSTRT0
CDDPYPAGE2	EQU	DPYSTRT1
	.ENDIF ;PAGE1

**
** CHECKDMA
**
** CALL WITH DINT, AND DISPOFF, DESTROYS VIDEO RAM
**
** SCRATCH: A0-A11
**
** JFL 04 MAR 93
**
CHECKDMA
	MOVI	CHECKDMAOBJ,A9

	;CLEAR MEM
	MOVI	CDSTARTXY,A0		;START
	MOVE	A0,A1
	MOVI	[100H,0],A2
	ADDXY	A2,A1			;END
	CLR	A14
CDCLR
	MOVL	A14,*A0+
	CMP	A1,A0
	JRLO	CDCLR

	;CLEAR A FEW PALS
	MOVI	COLRAM,A0
	MOVI	32*PALSIZE/32,A1
	CLR	A14
CDPCLR
	MOVL	A14,*A0+
	DSJ	A1,CDPCLR
	
	;RESET DMA
	CLR	A0
	MOVW	A0,@DMACTRL
	MOVW	A0,@DMACTRL
	MOVE	A0,@CMAPSEL		;CLEAR COLOR MAP SELECT
	MOVI	CDWIN,A0
	MOVL	A0,@DMATPLFT		;WINDOW BOTTOM:TOP
	MOVI	CDDPYPAGE,A0		;DISPLAY PAGE 1
	MOVW	A0,@DPYADR		;SET DISPLAY PAGE
	MOVW	A0,@DPYSTRT		;If we don't page flip next time
	
	;DMA OBJ
	MOVI	DMAREGS,A0
	MOVL	-*A9,-*A0	;SCALE
	MOVL	-*A9,A10
	MOVL	A10,-*A0	;CONST:PAL
	
	MOVL	-*A9,A1		;IHDR
	MOVE	A1,A11
	MOVL	*A1(ISIZE),A14
	MOVL	A14,-*A0	;SIZE
	
	MOVL	-*A9,A2
	MOVI	CDSTARTXY,A14
	ADDXY	A2,A14
	MOVL	A14,-*A0	;DAG

	MOVL	*A1(ISAG),A14
	MOVL	A14,-*A0	;SAG

	MOVL	-*A9,A14
	MOVW	*A1(ICTRL),A2
	SLL	16,A2
	OR	A2,A14
	MOVL	A14,-*A0	;CTRL:OFST

	;WAIT FOR DMA TO FINISH
	MOVI	26000/8,A1
CDWAIT
	MOVW	@DMACTRL,A0
	JRNN	CDWAITDONE
	DSJ	A1,CDWAIT
	TLOCKUP
	CLR	A0		;SIGNAL DMA IS STOPPED
	MOVW	A0,@DMACTRL
	MOVW	A0,@DMACTRL
CDWAITDONE
	
	;CHECKSUM RANGE	
	MOVI	CDSTARTXY,A0		;START
	MOVE	A0,A1
	MOVI	[100H,0],A2
	ADDXY	A2,A1			;END
	MOVI	PUSUMA,A3		;EXGPC
	CLR	A4			;COUNT
	CLR	A6			;VAL
	EXGPC	A3 ;IN:A0,A1,A2,A3,A4,A6 START,END,SC,EXGPC,COUNT,VAL
	
	;COMPARE CHECKSUM
	MOVL	-*A9,A0		;SHOULD BE
	CMP	A0,A6
	JREQ	CDOK
	
	MOVI	CDDPYPAGE2,A0		;DISPLAY PAGE 1
	MOVW	A0,@DPYADR		;SET DISPLAY PAGE
	MOVW	A0,@DPYSTRT		;If we don't page flip next time

	;SET THE PALETTE
	SLL	24,A10
	SRL	24-12,A10
	ADDI	COLRAM,A10
	MOVL	*A11(ICMAP),A0
	MOVW	*A0+,A1
CDPAL
	MOVW	*A0+,*A10+
	DSJ	A1,CDPAL	

	LOCKUP
CDOK
	;CLEAR MEM
	MOVI	CDSTARTXY,A0		;START
	MOVE	A0,A1
	MOVI	[100H,0],A2
	ADDXY	A2,A1			;END
	CLR	A14
CDCLR2
	MOVL	A14,*A0+
	CMP	A1,A0
	JRLO	CDCLR2

	RETS


* EOF
